# Async VS Sync
Асинхронный и синхронный парсер файлов XLS с сайта Spimex.


## Особенности
- Поддержка **синхронного и асинхронного** скачивания XLS-файлов.
- Асинхронный режим работает значительно быстрее при обработке большого количества файлов.
- Фильтрация строк с «Количество Договоров, шт.» > 0.
- Автоматическое создание таблицы `spimex_trading_results`.
- Сохранение всех данных о сделках, включая:
  - ID инструмента
  - Наименование инструмента
  - Базис поставки
  - Объем и сумму сделки
  - Дату сделки
  - Временные метки создания и обновления записи


## Установка
1. Клонируем репозиторий
```
git clone https://github.com/AndrewTsvirkunov/async-vs-sync.git
cd async-vs-sync
```
2. Создаем и активируем виртуальное окружение
```
python -m venv .venv
.\.venv\Scripts\activate
```
3. Устанавливаем зависимости
```
pip install -r requirements.txt
```


## Использование
В командной строке (терминале):
### Асинхронный режим
```
python async_vs_sync.py --pg postgresql://user:password@host/dbname --mode async --limit 10
```
### Синхронный режим
```
python async_vs_sync.py --pg postgresql://user:password@host/dbname --mode sync --limit 10
```
### Оба режима
```
python async_vs_sync.py --pg postgresql://user:password@host/dbname --mode both --limit 10
```
### Аргументы
- --pg — строка подключения к PostgreSQL (или используйте переменную окружения PG_URL)
- --limit — ограничение на количество файлов (по умолчанию 100)
- --mode — async, sync или both


## Сравнение скорости
| Режим | Время (сек) | Кол-во строк |
| ----- |-------------|--------------|
| Async | 4.65 с      | 4922         |
| Sync  | 19.77 с     | 4922         |

Асинхронный вариант даёт значительный выигрыш по скорости при одинаковом количестве файлов (при лимите равным 100).

